{% load static %}
<!doctype html>
<html lang="az">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Bar Panel</title>
    <link rel="stylesheet" href="{% static 'style/barmen_panel_style.css' %}">
</head>

<body>
<div class="wrap">
    <div class="topbar">
        <div>
            <div class="brand">Bar Panel</div>
            <div class="muted">Order intake + fulfillment. Less drama, more coffee.</div>
        </div>

        <div class="actions">
            <button class="btn" id="btnOpenIntake" type="button">Sifariş № daxil et</button>
        </div>
    </div>

    <div class="grid">
        <div class="card">
            <h2>Qəbul edilmiş sifarişlər</h2>
            <div class="muted">Click et, modal açılacaq. Status dəyişəcəksən.</div>

            <div class="kpi" id="kpis"></div>
            <div class="divider"></div>

            <div class="list" id="orderList"></div>
        </div>

        <div class="card">
            <h2>İş axını qaydası</h2>
            <div class="muted">
                1) Sifariş № daxil et → səbət gəlir → edit → <b>Qəbul et</b><br/>
                2) Order listə düşür (<span class="pill wait">WAITING</span>)<br/>
                3) Hazır olanda <b>Müştərini çağır</b> (<span class="pill called">CALLED</span>)<br/>
                4) Verəndə <b>Təhvil verdim</b> (<span class="pill done">DELIVERED</span>)
            </div>

            <div class="divider"></div>
        </div>
    </div>
</div>

<!-- Intake Modal (small) -->
<div class="modal-backdrop" id="intakeBackdrop" aria-hidden="true" style="display:none">
    <div class="modal small">
        <div class="modal-head">
            <div>
                <div style="font-weight:800">Sifariş qəbul et</div>
                <div class="muted">Sadəcə sifariş nömrəsini yaz, səbəti gətirək.</div>
            </div>
            <button class="x" data-close="intake" type="button">Bağla</button>
        </div>

        <div class="field">
            <label class="muted">Sifariş №</label>
            <input id="orderNoInput" placeholder="məs: 1052" inputmode="numeric"/>
        </div>

        <div style="display:flex;gap:10px;justify-content:flex-end">
            <button class="btn" data-close="intake" type="button">Ləğv et</button>
            <button class="btn primary" id="btnFetchCart" type="button">Səbəti gətir</button>
        </div>
    </div>
</div>

<!-- Order Details Modal -->
<div class="modal-backdrop" id="detailBackdrop" aria-hidden="true" style="display:none">
    <div class="modal">
        <div class="modal-head">
            <div>
                <div style="font-weight:900" id="detailTitle">Sifariş #</div>
                <div class="muted" id="detailMeta"></div>
            </div>
            <button class="x" data-close="detail" type="button">Bağla</button>
        </div>

        <div class="two">
            <div>
                <h2>Items (edit mümkündür)</h2>
                <div class="muted">“çıxart, əlavə et, qty dəyiş”.</div>
                <div class="divider"></div>

                <table id="itemsTable">
                    <thead>
                    <tr>
                        <th>Item</th>
                        <th>Qty</th>
                        <th class="right-align">Price</th>
                        <th class="right-align"></th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>

                <!-- DB-dən gələn məhsul dropdown -->
                <div class="field">
                    <label class="muted">Məhsul seç (DB-dən)</label>
                    <div style="display:flex;gap:10px">
                        <select id="productSelect" style="flex:1"></select>
                        <button class="btn" id="btnAddProduct" type="button">Əlavə et</button>
                    </div>
                    <div class="muted">Realda bu siyahı Django admin-dəki MenuItem-lardan gələcək.</div>
                </div>

                <div class="total">
                    <div class="muted">Total</div>
                    <div class="big" id="detailTotal">0.00 ₼</div>
                </div>
            </div>

            <div>
                <h2>Status actions</h2>
                <div class="muted">State machine kimi davran, “nə gəldi” yox.</div>
                <div class="divider"></div>

                <div style="display:flex;flex-direction:column;gap:10px">
                    <button class="btn good" id="btnAccept" type="button">Qəbul et (WAITING)</button>
                    <button class="btn warn" id="btnCall" type="button">Müştərini çağır (CALLED)</button>
                    <button class="btn bad" id="btnDeliver" type="button">Təhvil verdim (DELIVERED)</button>
                </div>

                <div class="divider"></div>

                <!-- ✅ SƏBƏTİ (ORDER) TAM SİL -->
                <button class="btn bad" id="btnDeleteOrder" type="button">Sifarişi sil</button>

                <div class="divider"></div>
                <h2>Qeydlər</h2>
                <div class="muted">
                    “Müştərini çağır” realda:
                    <ul>
                        <li>ekranda “Order # hazırdır” göstərə bilər</li>
                        <li>monitor varsa ona push edə bilər</li>
                        <li>SMS/Telegram inteqrasiyası ola bilər</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="module" src="{% static 'scripts/barmen_panel_script.js' %}"></script>
</body>
</html>
